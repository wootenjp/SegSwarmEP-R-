% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scoring.R
\name{calculate_score}
\alias{calculate_score}
\title{Score a candidate district assignment}
\usage{
calculate_score(
  assignment,
  adj_matrix,
  sf_data,
  group_a,
  group_b,
  total_col,
  id_col = NULL,
  county_col = NULL,
  penalty_contiguity,
  bonus_contiguity,
  compactness_scale,
  demographic_scale,
  num_districts,
  max_district_size
)
}
\arguments{
\item{assignment}{Integer vector of length \code{n} (number of school districts)
where each element is the proposed consolidated region (1 to
\code{num_districts}) that the school district belongs to.}

\item{adj_matrix}{Square 0/1 adjacency matrix (see \code{\link[=prepare_districts]{prepare_districts()}}).}

\item{sf_data}{The \code{sf} object returned by \code{\link[=prepare_districts]{prepare_districts()}} (must be
in a metric CRS with \code{center_x}/\code{center_y} columns).}

\item{group_a}{Character. Column name for demographic group A enrollment.}

\item{group_b}{Character. Column name for demographic group B enrollment.}

\item{total_col}{Character. Column name for total enrollment.}

\item{id_col}{Character or \code{NULL}. Column name for district identifiers.}

\item{county_col}{Character or \code{NULL}. Column name for county.}

\item{penalty_contiguity}{Numeric. Score penalty applied per non-contiguous
district (should be negative).}

\item{bonus_contiguity}{Numeric. Score bonus applied per contiguous district.}

\item{compactness_scale}{Numeric. Multiplier applied to the Polsby-Popper
score contribution.}

\item{demographic_scale}{Numeric. Multiplier applied to the demographic
(Theil's H) score contribution.}

\item{num_districts}{Integer. Expected number of consolidated districts.}

\item{max_district_size}{Numeric. Maximum total enrollment permitted per
consolidated district. Violations incur a proportional penalty.}
}
\value{
A single numeric score (higher is better), or \code{NA} if scoring fails
(e.g., empty districts or missing demographic data).
}
\description{
Evaluates a candidate assignment vector using three components:
geographic contiguity (penalty/bonus), compactness (Polsby-Popper), and
demographic segregation (Theil's H) across the proposed districts.
}
\examples{
\dontrun{
# Example: score a random assignment
download_example_data("ACO_7")
load("ACO_7_workspace.rda")

# Create a random assignment
n <- nrow(sf.dist)
random_assignment <- sample(1:7, n, replace = TRUE)

score <- calculate_score(
  assignment         = random_assignment,
  adj_matrix         = adj_matrix,
  sf_data            = sf.dist,
  group_a            = "wa",
  group_b            = "hb",
  total_col          = "total",
  penalty_contiguity = -30,
  bonus_contiguity   = 60,
  compactness_scale  = 120,
  demographic_scale  = 45,
  num_districts      = 7,
  max_district_size  = 124000
)
cat("Random assignment score:", score, "\n")
}

}
